<!DOCTYPE html>
<html>
<meta charset="utf-8">

<body>
    <script lang="javascript" src="xlsx.full.min.js"></script>

    <input type='file' onchange='importDataSource(this)' />
    <input type="text" name="ext_trade_name" id="ext_trade_name" placeholder="请输入表示用商品名" >
 

</body>

</html>

<script>

    var dataSource = null;
    var fileName = '';
    //1、importDataSource() 方法用来获取json数据
    function importDataSource(obj) {

        //2、obj.files[0]获得onchange文件，name获得文件名作为Excel的文件名
        var f = obj.files[0];

        //3、创建FileReader对象，将文件内容读入内存，通过一些api接口，可以在主线程中访问本地文件
        var reader = new FileReader();
        reader.readAsBinaryString(f);

        //5、onload事件，当读取操作成功完成时调用
        reader.onload = function (e) {
            var data = e.target.result;

            var workbook = XLSX.read(data, { type: 'binary' });
            var first_sheet_name = workbook.SheetNames[0]; // 获取工作簿中的工作表名字
            var cells = ['B2', 'C2', 'D2']; // 提供一个引用样式(单元格下标)

            var worksheet = workbook.Sheets[first_sheet_name]; // 获取对应的工作表对象
            for (address_of_cell in cells) {

                var desired_cell = worksheet[cells[address_of_cell]]; // 获取对应的单元格对象

                var desired_value = (desired_cell ? desired_cell.v : undefined);// 获取对应单元格中的数据
                if(address_of_cell ==1){
                    setValue(desired_value);
                }
                console.log(desired_value);
            }

            //读取完毕后输出结果 为字符串 此时需要转成json对象
            var json = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]]);
            //console.log(desired_value);
        }
    }

    function setValue(value){

    　　document.getElementsByName("ext_trade_name")[0].value=value;

    }




</script>
